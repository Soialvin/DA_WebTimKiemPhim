@model IEnumerable<DAM.Models.ViewModel.SuatChieu_RapViewModel>

@{
    ViewBag.Title = "SCRap";
    Layout = "~/Views/Layout/AdminLayout.cshtml";
    WebGrid grid = new WebGrid(source: Model, rowsPerPage: 5);
}

<div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Xác nhận xóa</h4>
            </div>

            <div class="modal-body">
                <p>Bạn có muốn xóa không?</p>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <a class="btn btn-danger btn-ok">Ok</a>
            </div>
        </div>
    </div>
</div>


<a href="@Url.Action("TaoMoiSCRap", "RapChieu", new {MaRap = ViewBag.MaRap})" id="btn_TaoMoi">
    <i class='fa-solid fa-plus fa-beat' style='color: #ffffff;'></i>
</a>
<div class="form-group col-lg-12">
    <a href="@Url.Action("ExportExcelSCRap","RapChieu",new {MaRap = ViewBag.MaRap})" class="btn btn-primary" style="float:right">Export Excel</a>
    @using (Html.BeginForm("TimKiemSCRap", "RapChieu", FormMethod.Get))
    {
        <input type="hidden" name="MaRap" value="@ViewBag.MaRap" />
        <div class="col-md-3">
            <input type="text" placeholder="Nhập từ khóa cần tìm" name="keyword" value="@ViewBag.Search" class="form-control" />
        </div>
        <div class="col-md-3">
            <input type="submit" value="Tìm kiếm" class="btn btn-success" />
        </div>
    }
</div>
<div id="ctn">
    @grid.GetHtml(
        tableStyle: "gridTable",
        headerStyle: "gridHead",
        footerStyle: "gridFooter",
        rowStyle: "gridRow",
        alternatingRowStyle: "gridAltRow",
        columns: grid.Columns(
            grid.Column("MaSC", "Mã suất chiếu"),
            grid.Column("MaRap", "Mã rạp"),
            grid.Column("NgayChieu", "Ngày chiếu", format: x => x.NgayChieu.ToString("dd/MM/yyyy")),
            grid.Column(format: x =>
            {
                var link = Url.Action("SuaSCRap", new { MaRap = x.MaRap, MaSC = x.MaSC ,NgayChieu = x.NgayChieu.ToString("dd/MM/yyyy") });
                return new HtmlString($"<a href='{link}'><i class=\"fa-regular fa-pen-to-square\" style=\"font-size: 30px;\"></i></a>");
            }),
            grid.Column(format: x =>
            {
                var link = Url.Action("XoaSCRap", new { MaRap = x.MaRap, MaSC = x.MaSC, NgayChieu = x.NgayChieu.ToString("dd/MM/yyyy") });
                return new HtmlString($"<a href=\"#\" data-href='{link}' data-toggle=\"modal\" data-target=\"#confirm-delete\"><i class=\"fa-solid fa-trash\" style=\"font-size: 30px;\"></i></a>");
            })
            ))
</div>


<style>
    .gridTable {
        width: 1250px;
    }

    .gridHead {
        border-bottom: 2px solid;
        position: sticky;
        top: 0;
        background-color: white;
    }

        .gridHead th {
            text-align: center;
        }

    .gridRow td,
    .gridAltRow td {
        text-align: center;
        height: 100px;
        border-bottom: 2px solid #7F8C8D;
    }

    .gridFooter {
        position: sticky;
        bottom: 0;
        background-color: white;
    }

        .gridFooter td {
            font-weight: bold;
            padding-left: 30px;
        }

    #ctn {
        width: 99%;
        margin: 0 auto;
        overflow: scroll;
        height: 535px
    }

    ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
    }

    ::-webkit-scrollbar-thumb {
        background-color: grey;
        border-radius: 5px;
    }

        ::-webkit-scrollbar-thumb:hover {
            background-color: #449D44;
        }

    .gridTable tr td a i:hover {
        color: orangered;
    }
</style>
<script>
    $('#confirm-delete').on('show.bs.modal', function (e) {
        $(this).find('.btn-ok').attr('href', $(e.relatedTarget).data('href'));

        $('.debug-url').html('Delete URL: <strong>' + $(this).find('.btn-ok').attr('href') + '</strong>');
    });
</script>

